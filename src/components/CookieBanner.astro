<div id="cookie-banner" class="fixed bottom-0 left-0 right-0 bg-slate-900 text-white p-4 transform translate-y-full transition-transform duration-300 z-50 shadow-lg border-t border-slate-700 hidden">
    <div class="max-w-4xl mx-auto flex flex-col md:flex-row items-center justify-between gap-4">
        <div class="text-sm text-slate-300">
            <p>
                Utilizamos cookies para analisar o tráfego e melhorar sua experiência. 
                Ao aceitar, você concorda com nossa <a href="/politica-privacidade" class="text-blue-400 hover:underline">Política de Privacidade</a>.
            </p>
        </div>
        <div class="flex gap-3">
            <button id="btn-reject" class="px-4 py-2 text-sm font-bold text-slate-300 hover:text-white transition-colors">
                Recusar
            </button>
            <button id="btn-accept" class="px-6 py-2 text-sm font-bold bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-md">
                Aceitar
            </button>
        </div>
    </div>
</div>

<script is:inline>
    // ID do seu GTM/GA4 (Mantido inalterado)
    const GTM_ID = 'G-YCSN4DV5Q4';

    function loadGoogleAnalytics() {
        // Cria a tag script do GA4 dinamicamente
        const script = document.createElement('script');
        script.async = true;
        script.src = `https://www.googletagmanager.com/gtag/js?id=${GTM_ID}`;
        document.head.appendChild(script);

        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', GTM_ID);
        
        console.log('Google Analytics Carregado');
    }

    // Lógica do Banner
    document.addEventListener('DOMContentLoaded', () => {
        const banner = document.getElementById('cookie-banner');
        const btnAccept = document.getElementById('btn-accept');
        const btnReject = document.getElementById('btn-reject');
        
        // Verifica se já existe uma escolha salva
        const consent = localStorage.getItem('cookie-consent');

        if (consent === 'accepted') {
            loadGoogleAnalytics();
        } else if (!consent) {
            // Se não houver escolha, mostra o banner (remove o hidden e anima)
            banner.classList.remove('hidden');
            // Pequeno delay para a animação de subida funcionar
            setTimeout(() => {
                banner.classList.remove('translate-y-full');
            }, 100);
        }

        // Ação de Aceitar
        btnAccept.addEventListener('click', () => {
            localStorage.setItem('cookie-consent', 'accepted');
            banner.classList.add('translate-y-full'); // Esconde
            loadGoogleAnalytics(); // Carrega o GA
        });

        // Ação de Recusar
        btnReject.addEventListener('click', () => {
            localStorage.setItem('cookie-consent', 'rejected');
            banner.classList.add('translate-y-full'); // Esconde
            // Não carregamos o GA
        });

        // --- NOVO: Lógica para o botão do Rodapé "Gerenciar Cookies" ---
        const btnReset = document.getElementById('btn-reset-cookies');
        if (btnReset) {
            btnReset.addEventListener('click', (e) => {
                e.preventDefault(); // Evita comportamento padrão de link se houver
                
                // Remove a escolha salva para permitir nova decisão
                localStorage.removeItem('cookie-consent');
                
                // Mostra o banner novamente
                banner.classList.remove('hidden');
                setTimeout(() => {
                    banner.classList.remove('translate-y-full');
                }, 100);
            });
        }
    });
</script>